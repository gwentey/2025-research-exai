<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Architecture Technique du Projet EXAI :: Documentation 2025 Research EXAI</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Documentation 2025 Research EXAI</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="EXAI" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Documentation Principale</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Accueil</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../getting-started.html">Guide de démarrage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guide Utilisateur</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/account-management.adoc">Gestion du compte</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../user-guide/account-deletion.html">Suppression du compte</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../user-guide/dataset-selection.html">Sélection de datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../user-guide/dataset-detailed-view.html">Vue détaillée des datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/project-creation.adoc">Création de projets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../user-guide/project-management.html">Gestion des projets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/model-training.adoc">Entraînement de modèles</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/xai-analysis.adoc">Analyse XAI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/report-generation.adoc">Génération de rapports</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/results-interpretation.adoc">Interprétation des résultats</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guide Développeur</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api-reference.html">Référence API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="authentication-error-messages.html">Messages d&#8217;erreur d&#8217;authentification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/code-style-guide.adoc">Guide de style de code</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/component-library.adoc">Bibliothèque de composants</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/deployment-checklist.adoc">Checklist de déploiement</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/docker-compose-setup.adoc">Configuration Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/environment-variables.adoc">Variables d&#8217;environnement</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/error-handling.adoc">Gestion des erreurs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/frontend-architecture.adoc">Architecture Frontend</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/i18n-guide.adoc">Guide d&#8217;internationalisation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/local-development.adoc">Développement local</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/logging-guide.adoc">Guide de journalisation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/ml-pipeline-integration.adoc">Intégration ML Pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/performance-optimization.adoc">Optimisation des performances</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/security-guidelines.adoc">Directives de sécurité</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/testing-strategy.adoc">Stratégie de test</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/troubleshooting.adoc">Dépannage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/user-authentication.adoc">Authentification utilisateur</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/xai-engine-integration.adoc">Intégration XAI Engine</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guides de Données</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dataset-management-guide.html">Guide de Gestion des Datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="auto-dataset-initialization.html">Auto-Initialisation des Datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="object-storage-implementation.html">Implémentation du Stockage d&#8217;Objets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="storage-setup-guide.html">Guide de Configuration du Stockage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guides de Déploiement</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development/azure-deployment.html">Déploiement Azure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development/database-migrations.html">Migrations de base de données</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Documentation Principale</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Documentation Principale</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Documentation Principale</a></li>
    <li>Guide Développeur</li>
    <li><a href="architecture.html">Architecture</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///C:/xampp/htdocs/2025-research-exai/docs/modules/ROOT/pages/dev-guide/architecture.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Architecture Technique du Projet EXAI</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Ce document détaille l&#8217;architecture logicielle de la plateforme EXAI. Pour les instructions d&#8217;installation et de déploiement, veuillez consulter le guide <a href="../getting-started.html" class="xref page">Installation &amp; Démarrage Rapide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_vision_densemble_et_objectifs"><a class="anchor" href="#_1_vision_densemble_et_objectifs"></a>1. Vision d&#8217;Ensemble et Objectifs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Le projet EXAI vise à créer un <strong>outil scientifique (PoC)</strong> répondant à trois défis :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Aide à la <strong>sélection de datasets</strong> (critères techniques, éthiques, métier).</p>
</li>
<li>
<p>Guidage interactif pour les <strong>pipelines de Machine Learning</strong>.</p>
</li>
<li>
<p>Recommandation et application de techniques d'<strong>IA Explicable (XAI)</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Pour atteindre ces objectifs avec <strong>modularité</strong>, <strong>scalabilité</strong> et <strong>maintenabilité</strong>, EXAI repose sur une architecture en <strong>microservices conteneurisés</strong> orchestrés par <strong>Kubernetes</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Microservices :</strong> Chaque grande fonctionnalité (sélection de données, entraînement ML, explicabilité XAI, interface utilisateur) est gérée par un service indépendant. Cela permet de développer, déployer et mettre à l&#8217;échelle chaque partie séparément.</p>
</li>
<li>
<p><strong>Conteneurisation (Docker) :</strong> Chaque microservice est packagé dans une image Docker avec toutes ses dépendances. Cela garantit la cohérence entre les environnements (développement, test, production).</p>
</li>
<li>
<p><strong>Orchestration (Kubernetes) :</strong> Kubernetes gère le déploiement, la mise à l&#8217;échelle, la mise en réseau et la communication entre les conteneurs/microservices. Pour le développement local, nous utilisons <strong>Minikube</strong> qui simule un cluster Kubernetes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_diagramme_darchitecture"><a class="anchor" href="#_2_diagramme_darchitecture"></a>2. Diagramme d&#8217;Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>(Essentiel : Un diagramme est nécessaire ici pour visualiser les interactions !)</em></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Un diagramme d&#8217;architecture illustrant les composants décrits ci-dessous et leurs interactions principales doit être inséré ici.</p>
</div>
<div class="paragraph">
<p>Le moyen le plus simple est de créer le diagramme avec un outil externe (comme <a href="https://draw.io" target="_blank" rel="noopener">draw.io</a>, Lucidchart, Miro&#8230;&#8203;) et de l&#8217;enregistrer sous forme d&#8217;image (par exemple, <code>architecture-diagram.png</code>) dans le dossier <code>docs/modules/ROOT/assets/images/</code>. Ensuite, incluez-le avec la ligne suivante :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-asciidoc hljs" data-lang="asciidoc">image::architecture-diagram.png[Diagramme d'architecture EXAI, L=auto]</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Assurez-vous que le chemin d&#8217;accès à l&#8217;image est correct par rapport à l&#8217;emplacement de ce fichier <code>architecture.adoc</code>.)</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_description_détaillée_des_composants"><a class="anchor" href="#_3_description_détaillée_des_composants"></a>3. Description Détaillée des Composants</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_3_1_frontend_frontend"><a class="anchor" href="#_3_1_frontend_frontend"></a>3.1 Frontend (<code>frontend/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Interface utilisateur web interactive pour la plateforme EXAI.</p>
</li>
<li>
<p><strong>Responsabilités :</strong> Permettre à l&#8217;utilisateur de naviguer dans les fonctionnalités (sélection datasets, configuration pipeline ML, visualisation XAI), afficher les informations et résultats.</p>
</li>
<li>
<p><strong>Technologies :</strong> Angular, Tailwind CSS.</p>
</li>
<li>
<p><strong>Interactions :</strong> Communique exclusivement avec l&#8217;API Gateway via des requêtes HTTP REST/JSON.</p>
</li>
<li>
<p><strong>Justification :</strong> Angular offre un framework robuste pour les applications Single Page complexes. Tailwind facilite la création rapide d&#8217;interfaces modernes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_api_gateway_api_gateway"><a class="anchor" href="#_3_2_api_gateway_api_gateway"></a>3.2 API Gateway (<code>api-gateway/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Point d&#8217;entrée unique pour toutes les requêtes provenant du Frontend (ou d&#8217;autres clients externes).</p>
</li>
<li>
<p><strong>Responsabilités :</strong></p>
</li>
<li>
<p>Authentification et autorisation des requêtes (via JWT).</p>
</li>
<li>
<p>Routage des requêtes vers le microservice interne approprié (Sélection, ML, XAI).</p>
</li>
<li>
<p>Agrégation potentielle de réponses provenant de plusieurs services.</p>
</li>
<li>
<p>Gestion centralisée du CORS (Cross-Origin Resource Sharing).</p>
</li>
<li>
<p><strong>Technologies :</strong> FastAPI (Python).</p>
</li>
<li>
<p><strong>Interactions :</strong> Reçoit les requêtes du Frontend, les transmet aux services backend (Sélection, ML, XAI) via REST.</p>
</li>
<li>
<p><strong>Justification :</strong> FastAPI est performant, facile à utiliser, intègre la validation de données (Pydantic) et génère automatiquement la documentation OpenAPI (Swagger UI), idéal pour une gateway.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_3_service_sélection_service_selection"><a class="anchor" href="#_3_3_service_sélection_service_selection"></a>3.3 Service Sélection (<code>service-selection/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Gérer le catalogue de datasets et fournir des fonctionnalités de sélection.</p>
</li>
<li>
<p><strong>Responsabilités :</strong></p>
</li>
<li>
<p>Stocker et récupérer les métadonnées des datasets (nom, description, type, caractéristiques&#8230;&#8203;).</p>
</li>
<li>
<p>Implémenter la logique de recherche et de filtrage des datasets selon les critères utilisateur.</p>
</li>
<li>
<p>Calculer les scores de pertinence des datasets.</p>
</li>
<li>
<p><strong>Technologies :</strong> FastAPI (Python), SQLAlchemy (potentiellement, pour l&#8217;ORM), PostgreSQL (pour le stockage).</p>
</li>
<li>
<p><strong>Interactions :</strong> Reçoit des requêtes de l&#8217;API Gateway, interagit avec la base de données PostgreSQL.</p>
</li>
<li>
<p><strong>Justification :</strong> FastAPI pour la rapidité de développement API. PostgreSQL est une base de données relationnelle robuste et éprouvée.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_4_service_ml_service_ml"><a class="anchor" href="#_3_4_service_ml_service_ml"></a>3.4 Service ML (<code>service-ml/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Gérer les aspects liés à l&#8217;entraînement et à l&#8217;évaluation des modèles de Machine Learning.</p>
</li>
<li>
<p><strong>Responsabilités (Prévues) :</strong></p>
</li>
<li>
<p>Prétraitement des données (nettoyage, normalisation&#8230;&#8203;).</p>
</li>
<li>
<p>Entraînement de modèles (classification, régression&#8230;&#8203;) basés sur les choix utilisateur.</p>
</li>
<li>
<p>Évaluation des performances des modèles.</p>
</li>
<li>
<p>Gestion des tâches longues (entraînement) de manière asynchrone.</p>
</li>
<li>
<p><strong>Technologies :</strong> FastAPI (Python), Scikit-learn, Pandas, Celery (pour les tâches asynchrones), Redis (comme broker pour Celery).</p>
</li>
<li>
<p><strong>Interactions :</strong> Reçoit des requêtes de l&#8217;API Gateway, lit potentiellement des données (via le Service Sélection ou directement ?), utilise Celery/Redis pour les tâches longues, peut interagir avec le Service XAI.</p>
</li>
<li>
<p><strong>Justification :</strong> Scikit-learn est la bibliothèque standard pour le ML en Python. Celery/Redis gèrent efficacement les traitements longs sans bloquer l&#8217;API.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_5_service_xai_service_xai"><a class="anchor" href="#_3_5_service_xai_service_xai"></a>3.5 Service XAI (<code>service-xai/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Fournir des fonctionnalités d&#8217;explicabilité pour les modèles ML.</p>
</li>
<li>
<p><strong>Responsabilités (Prévues) :</strong></p>
</li>
<li>
<p>Recommander des méthodes XAI adaptées (LIME, SHAP&#8230;&#8203;) en fonction du modèle, des données, du contexte.</p>
</li>
<li>
<p>Générer les explications (calculs potentiellement longs).</p>
</li>
<li>
<p>Formater les résultats des explications pour la visualisation.</p>
</li>
<li>
<p>Gérer les tâches de génération d&#8217;explication de manière asynchrone.</p>
</li>
<li>
<p><strong>Technologies :</strong> FastAPI (Python), SHAP, LIME, autres bibliothèques XAI, Celery, Redis.</p>
</li>
<li>
<p><strong>Interactions :</strong> Reçoit des requêtes de l&#8217;API Gateway, interagit probablement avec le Service ML (pour obtenir le modèle, les données), utilise Celery/Redis.</p>
</li>
<li>
<p><strong>Justification :</strong> Bibliothèques XAI dédiées (SHAP, LIME). Celery/Redis pour les calculs longs.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_6_base_de_données_k8sbasepostgres"><a class="anchor" href="#_3_6_base_de_données_k8sbasepostgres"></a>3.6 Base de Données (<code>k8s/base/postgres/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Stockage persistant des données relationnelles.</p>
</li>
<li>
<p><strong>Responsabilités :</strong> Principalement utilisée par le Service Sélection pour stocker les métadonnées des datasets. Pourrait être utilisée par d&#8217;autres services si nécessaire.</p>
</li>
<li>
<p><strong>Technologies :</strong> PostgreSQL.</p>
</li>
<li>
<p><strong>Interactions :</strong> Accessible par les microservices (principalement Service Sélection) via le réseau interne de Kubernetes.</p>
</li>
<li>
<p><strong>Justification :</strong> Système de gestion de base de données relationnelle open-source, fiable, performant et riche en fonctionnalités.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_7_orchestration_infrastructure_k8s"><a class="anchor" href="#_3_7_orchestration_infrastructure_k8s"></a>3.7 Orchestration &amp; Infrastructure (<code>k8s/</code>)</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Rôle :</strong> Définir, construire et gérer l&#8217;exécution de l&#8217;ensemble des services.</p>
</li>
<li>
<p><strong>Responsabilités :</strong></p>
</li>
<li>
<p>Définir comment construire les images conteneurs (via les <code>Dockerfile</code> dans chaque service).</p>
</li>
<li>
<p>Définir comment déployer et configurer chaque service dans Kubernetes (via les manifestes YAML dans <code>k8s/base/</code> et <code>k8s/overlays/</code>).</p>
</li>
<li>
<p>Gérer la mise en réseau, le stockage persistant (via Kubernetes).</p>
</li>
<li>
<p><strong>Technologies :</strong> Docker, Kubernetes, Minikube (pour le local), Skaffold (pour l&#8217;automatisation du déploiement).</p>
</li>
<li>
<p><strong>Justification :</strong> Standards de l&#8217;industrie pour la conteneurisation et l&#8217;orchestration, favorisant la reproductibilité et la scalabilité.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_flux_de_données_et_communication"><a class="anchor" href="#_4_flux_de_données_et_communication"></a>4. Flux de Données et Communication</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Communication Inter-Services :</strong> La communication entre le Frontend et l&#8217;API Gateway, ainsi qu&#8217;entre l&#8217;API Gateway et les microservices backend, se fait principalement via des <strong>API REST synchrones</strong> (requête/réponse HTTP/JSON).</p>
</li>
<li>
<p><strong>Tâches Asynchrones :</strong> Pour les opérations longues (entraînement de modèles ML, génération d&#8217;explications XAI), les services ML et XAI utilisent <strong>Celery</strong> avec <strong>Redis</strong> comme broker de messages. L&#8217;API reçoit la requête, la place dans une file d&#8217;attente Redis, et un worker Celery (processus séparé) la prend en charge. Cela évite de bloquer les requêtes API.</p>
</li>
<li>
<p><strong>Sécurité :</strong> L'<strong>API Gateway</strong> est responsable de la validation des jetons <strong>JWT</strong> pour sécuriser l&#8217;accès aux API.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_structure_du_code_source"><a class="anchor" href="#_5_structure_du_code_source"></a>5. Structure du Code Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Voici la structure actualisée du code source, reflétant la centralisation des configurations Kubernetes dans le dossier <code>k8s/</code> à la racine :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">/
├── frontend/                 # Code source de l'interface Angular
│   ├── src/
│   ├── angular.json
│   └── Dockerfile            # Pour construire l'image du frontend
├── api-gateway/              # Code source de l'API Gateway
│   ├── app/
│   ├── requirements.txt
│   └── Dockerfile
├── service-selection/        # Code source du Service Sélection
│   ├── app/
│   ├── requirements.txt
│   └── Dockerfile
├── service-ml/               # Code source du Service ML (prévu)
│   ├── app/
│   ├── worker/               # Code pour les workers Celery
│   ├── requirements.txt
│   └── Dockerfile
├── service-xai/              # Code source du Service XAI (prévu)
│   ├── ...
├── k8s/                      # Configurations Kubernetes centralisées
│   ├── base/                 # Configurations de base communes
│   │   ├── api-gateway/      # Configurations K8s pour l'API Gateway
│   │   │   ├── deployment.yaml
│   │   │   ├── gateway-secrets.yaml
│   │   │   └── service.yaml
│   │   ├── frontend/         # Configurations K8s pour le Frontend
│   │   │   ├── deployment.yaml
│   │   │   └── service.yaml
│   │   ├── postgres/         # Configurations K8s pour PostgreSQL
│   │   │   ├── postgresql-deployment.yaml
│   │   │   ├── postgresql-service.yaml
│   │   │   └── postgresql-pvc.yaml      # Si nécessaire
│   │   ├── service-selection/ # Configurations K8s pour le Service Sélection
│   │   │   ├── deployment.yaml
│   │   │   ├── db-secrets.yaml
│   │   │   └── service.yaml
│   │   └── kustomization.yaml # Fichier déclarant toutes les ressources de base
│   ├── overlays/             # Surcouches de configuration pour différents environnements
│   │   └── azure/            # Configuration spécifique au déploiement sur Azure
│   │       └── kustomization.yaml # Utilise kustomize pour appliquer des modifications sur la base
├── docs/                     # Documentation Antora (ce que vous lisez)
│   └── modules/ROOT/
│       ├── pages/
│       └── nav.adoc
├── antora.yml                # Configuration du composant Antora
├── antora-playbook.yml       # Playbook pour générer la documentation
└── skaffold.yaml             # Configuration Skaffold pour automatiser build et déploiement</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette nouvelle structure reflète l&#8217;organisation actualisée où tous les fichiers de configuration Kubernetes sont centralisés dans le dossier <code>k8s/</code> à la racine du projet, divisé en <code>base/</code> (configurations communes) et <code>overlays/</code> (configurations spécifiques à chaque environnement) selon les principes de Kustomize. Les microservices conservent uniquement leur code source et leurs Dockerfiles.</p>
</div>
</div>
</div>
<h1 id="_architecture_du_reverse_proxy" class="sect0"><a class="anchor" href="#_architecture_du_reverse_proxy"></a>Architecture du Reverse Proxy</h1>
<div class="paragraph">
<p>Ce document explique comment l&#8217;API Gateway EXAI fait du reverse proxy vers les services backend et comment cette configuration fonctionne automatiquement en développement et en production.</p>
</div>
<div class="sect1">
<h2 id="_vue_densemble"><a class="anchor" href="#_vue_densemble"></a>1. Vue d&#8217;ensemble</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;API Gateway (port 9000) sert de point d&#8217;entrée unique pour toutes les requêtes API. Il fait du reverse proxy vers les différents services backend, permettant au frontend d&#8217;avoir une seule URL d&#8217;API tout en conservant les avantages de l&#8217;architecture microservices.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_automatique"><a class="anchor" href="#_configuration_automatique"></a>2. Configuration Automatique</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_valeurs_par_défaut"><a class="anchor" href="#_valeurs_par_défaut"></a>2.1. Valeurs par Défaut</h3>
<div class="paragraph">
<p>Les URLs des services backend sont configurées automatiquement pour fonctionner avec Kubernetes (Minikube en développement, AKS en production) :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># api-gateway/app/core/config.py
SERVICE_SELECTION_URL: str = os.getenv("SERVICE_SELECTION_URL", "http://service-selection-service.exai.svc.cluster.local")
ML_PIPELINE_URL: str = os.getenv("ML_PIPELINE_URL", "http://ml-pipeline-service.exai.svc.cluster.local")
XAI_ENGINE_URL: str = os.getenv("XAI_ENGINE_URL", "http://xai-engine-service.exai.svc.cluster.local")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ces URLs utilisent le DNS interne de Kubernetes et fonctionnent automatiquement sans configuration supplémentaire.</p>
</div>
</div>
<div class="sect2">
<h3 id="_routage_des_requêtes"><a class="anchor" href="#_routage_des_requêtes"></a>2.2. Routage des Requêtes</h3>
<div class="paragraph">
<p>L&#8217;API Gateway intercepte et redirige les requêtes selon le pattern suivant :</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 37.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Service de Destination</th>
<th class="tableblock halign-left valign-top">Exemple</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/datasets/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVICE_SELECTION_URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/datasets</code> → <code><a href="http://service-selection-service.exai.svc.cluster.local/datasets" class="bare">http://service-selection-service.exai.svc.cluster.local/datasets</a></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ml-pipeline/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ML_PIPELINE_URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ml-pipeline/jobs</code> → <code><a href="http://ml-pipeline-service.exai.svc.cluster.local/jobs" class="bare">http://ml-pipeline-service.exai.svc.cluster.local/jobs</a></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/xai/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAI_ENGINE_URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/xai/explain</code> → <code><a href="http://xai-engine-service.exai.svc.cluster.local/explain" class="bare">http://xai-engine-service.exai.svc.cluster.local/explain</a></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implémentation_technique"><a class="anchor" href="#_implémentation_technique"></a>3. Implémentation Technique</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_fonction_proxy_générique"><a class="anchor" href="#_fonction_proxy_générique"></a>3.1. Fonction Proxy Générique</h3>
<div class="paragraph">
<p>L&#8217;API Gateway utilise une fonction <code>proxy_request</code> générique qui :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Construit l&#8217;URL de destination</p>
</li>
<li>
<p>Transmet les paramètres de query</p>
</li>
<li>
<p>Transmet le body pour les requêtes POST/PUT/PATCH</p>
</li>
<li>
<p>Gère les erreurs de communication</p>
</li>
<li>
<p>Retourne la réponse du service backend</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def proxy_request(
    request: Request,
    service_url: str,
    path: str,
    current_user: UserModel
):
    # Construire l'URL complète
    target_url = f"{service_url.rstrip('/')}/{path.lstrip('/')}"

    # Faire la requête avec httpx
    async with httpx.AsyncClient(timeout=30.0) as client:
        response = await client.request(
            method=request.method,
            url=target_url,
            params=dict(request.query_params),
            headers={"Content-Type": "application/json"},
            content=await request.body() if request.method in ["POST", "PUT", "PATCH"] else None
        )

        return JSONResponse(
            status_code=response.status_code,
            content=response.json() if response.content else None
        )</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_routes_proxy"><a class="anchor" href="#_routes_proxy"></a>3.2. Routes Proxy</h3>
<div class="paragraph">
<p>Chaque service backend a ses routes proxy dédiées :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@app.api_route("/datasets", methods=["GET", "POST"], tags=["datasets"])
async def datasets_proxy(request: Request, current_user: UserModel = Depends(current_active_user)):
    return await proxy_request(request, settings.SERVICE_SELECTION_URL, "datasets", current_user)

@app.get("/datasets/domains", tags=["datasets"])
async def datasets_domains_proxy(request: Request, current_user: UserModel = Depends(current_active_user)):
    return await proxy_request(request, settings.SERVICE_SELECTION_URL, "datasets/domains", current_user)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_environnements"><a class="anchor" href="#_environnements"></a>4. Environnements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_développement_local_minikube"><a class="anchor" href="#_développement_local_minikube"></a>4.1. Développement Local (Minikube)</h3>
<div class="paragraph">
<p>Les services communiquent via le DNS interne de Kubernetes :
- <code>service-selection-service.exai.svc.cluster.local</code>
- <code>ml-pipeline-service.exai.svc.cluster.local</code>
- <code>xai-engine-service.exai.svc.cluster.local</code></p>
</div>
<div class="paragraph">
<p>Aucune configuration supplémentaire n&#8217;est nécessaire.</p>
</div>
</div>
<div class="sect2">
<h3 id="_développement_local_services_en_local"><a class="anchor" href="#_développement_local_services_en_local"></a>4.2. Développement Local (Services en Local)</h3>
<div class="paragraph">
<p>Si vous voulez faire tourner les services directement sur votre machine, créez un fichier <code>.env</code> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">SERVICE_SELECTION_URL=http://localhost:8001
ML_PIPELINE_URL=http://localhost:8002
XAI_ENGINE_URL=http://localhost:8003</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_production_azure"><a class="anchor" href="#_production_azure"></a>4.3. Production (Azure)</h3>
<div class="paragraph">
<p>Les services communiquent via le DNS interne d&#8217;AKS avec les mêmes URLs que Minikube. Les variables d&#8217;environnement peuvent être surchargées via des secrets Kubernetes si nécessaire.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gestion_des_erreurs"><a class="anchor" href="#_gestion_des_erreurs"></a>5. Gestion des Erreurs</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_erreurs_de_communication"><a class="anchor" href="#_erreurs_de_communication"></a>5.1. Erreurs de Communication</h3>
<div class="paragraph">
<p>Si un service backend n&#8217;est pas disponible, l&#8217;API Gateway retourne :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "detail": "Service temporairement indisponible"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Avec un code de statut HTTP 503 (Service Unavailable).</p>
</div>
</div>
<div class="sect2">
<h3 id="_erreurs_de_service"><a class="anchor" href="#_erreurs_de_service"></a>5.2. Erreurs de Service</h3>
<div class="paragraph">
<p>Si un service backend retourne une erreur, l&#8217;API Gateway propage le code de statut et la réponse exacte du service.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sécurité"><a class="anchor" href="#_sécurité"></a>6. Sécurité</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_authentification"><a class="anchor" href="#_authentification"></a>6.1. Authentification</h3>
<div class="paragraph">
<p>Toutes les routes proxy requièrent une authentification :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">current_user: UserModel = Depends(current_active_user)</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;utilisateur authentifié est passé à la fonction proxy mais n&#8217;est pas actuellement transmis au service backend (évolution future).</p>
</div>
</div>
<div class="sect2">
<h3 id="_headers"><a class="anchor" href="#_headers"></a>6.2. Headers</h3>
<div class="paragraph">
<p>L&#8217;API Gateway transmet les headers suivants aux services backend :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Content-Type: application/json</code></p>
</li>
<li>
<p><code>User-Agent: API-Gateway-Proxy/1.0</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_monitoring_et_observabilité"><a class="anchor" href="#_monitoring_et_observabilité"></a>7. Monitoring et Observabilité</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_logs"><a class="anchor" href="#_logs"></a>7.1. Logs</h3>
<div class="paragraph">
<p>L&#8217;API Gateway log toutes les requêtes proxy avec :
- URL de destination
- Méthode HTTP
- Code de statut de réponse
- Erreurs de communication</p>
</div>
</div>
<div class="sect2">
<h3 id="_métriques"><a class="anchor" href="#_métriques"></a>7.2. Métriques</h3>
<div class="paragraph">
<p>Les métriques suivantes sont disponibles :
- Nombre de requêtes par service
- Temps de réponse moyen
- Taux d&#8217;erreur par service</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_évolution_et_extensibilité"><a class="anchor" href="#_évolution_et_extensibilité"></a>8. Évolution et Extensibilité</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ajout_de_nouveaux_services"><a class="anchor" href="#_ajout_de_nouveaux_services"></a>8.1. Ajout de Nouveaux Services</h3>
<div class="paragraph">
<p>Pour ajouter un nouveau service backend :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ajouter la variable d&#8217;environnement dans <code>config.py</code></p>
</li>
<li>
<p>Créer les routes proxy dans <code>main.py</code></p>
</li>
<li>
<p>Mettre à jour la documentation</p>
</li>
<li>
<p>Déployer les services Kubernetes</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_load_balancing"><a class="anchor" href="#_load_balancing"></a>8.2. Load Balancing</h3>
<div class="paragraph">
<p>Kubernetes gère automatiquement le load balancing entre les réplicas de chaque service. L&#8217;API Gateway n&#8217;a pas besoin de configuration supplémentaire.</p>
</div>
</div>
<div class="sect2">
<h3 id="_circuit_breaker"><a class="anchor" href="#_circuit_breaker"></a>8.3. Circuit Breaker</h3>
<div class="paragraph">
<p>Une évolution future pourrait inclure un circuit breaker pour gérer les pannes temporaires des services backend.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>

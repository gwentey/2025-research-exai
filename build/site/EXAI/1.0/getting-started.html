<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>üöÄ Installation et D√©marrage d&#8217;EXAI :: Documentation 2025 Research EXAI</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">Documentation 2025 Research EXAI</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="EXAI" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Documentation Principale</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Accueil</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="getting-started.html">Guide de d√©marrage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guide Utilisateur</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/account-management.adoc">Gestion du compte</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="user-guide/account-deletion.html">Suppression du compte</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="user-guide/dataset-selection.html">S√©lection de datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="user-guide/dataset-detailed-view.html">Vue d√©taill√©e des datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/project-creation.adoc">Cr√©ation de projets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="user-guide/project-management.html">Gestion des projets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/model-training.adoc">Entra√Ænement de mod√®les</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/xai-analysis.adoc">Analyse XAI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/report-generation.adoc">G√©n√©ration de rapports</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#user-guide/results-interpretation.adoc">Interpr√©tation des r√©sultats</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guide D√©veloppeur</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/api-reference.html">R√©f√©rence API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/authentication-error-messages.html">Messages d&#8217;erreur d&#8217;authentification</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/code-style-guide.adoc">Guide de style de code</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/component-library.adoc">Biblioth√®que de composants</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/deployment-checklist.adoc">Checklist de d√©ploiement</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/docker-compose-setup.adoc">Configuration Docker Compose</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/environment-variables.adoc">Variables d&#8217;environnement</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/error-handling.adoc">Gestion des erreurs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/frontend-architecture.adoc">Architecture Frontend</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/i18n-guide.adoc">Guide d&#8217;internationalisation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/local-development.adoc">D√©veloppement local</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/logging-guide.adoc">Guide de journalisation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/ml-pipeline-integration.adoc">Int√©gration ML Pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/performance-optimization.adoc">Optimisation des performances</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/security-guidelines.adoc">Directives de s√©curit√©</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/testing-strategy.adoc">Strat√©gie de test</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/troubleshooting.adoc">D√©pannage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/user-authentication.adoc">Authentification utilisateur</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#dev-guide/xai-engine-integration.adoc">Int√©gration XAI Engine</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guides de Donn√©es</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/dataset-management-guide.html">Guide de Gestion des Datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/auto-dataset-initialization.html">Auto-Initialisation des Datasets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/object-storage-implementation.html">Impl√©mentation du Stockage d&#8217;Objets</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="dev-guide/storage-setup-guide.html">Guide de Configuration du Stockage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guides de D√©ploiement</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="development/azure-deployment.html">D√©ploiement Azure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="development/database-migrations.html">Migrations de base de donn√©es</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Documentation Principale</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="index.html">Documentation Principale</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Documentation Principale</a></li>
    <li><a href="getting-started.html">Guide de d√©marrage</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="file:///C:/xampp/htdocs/2025-research-exai/docs/modules/ROOT/pages/getting-started.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">üöÄ Installation et D√©marrage d&#8217;EXAI</h1>
<div class="sect1">
<h2 id="_pr√©requis"><a class="anchor" href="#_pr√©requis"></a>Pr√©requis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installez les outils suivants:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Outil</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker Desktop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moteur de conteneurisation - <a href="https://www.docker.com/products/docker-desktop/">T√©l√©charger</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes local - <code>choco install minikube</code> (Windows) ou <code>brew install minikube</code> (macOS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kubectl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLI Kubernetes - <code>choco install kubernetes-cli</code> (Windows) ou <code>brew install kubectl</code> (macOS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skaffold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Workflow Kubernetes - <code>choco install skaffold</code> (Windows) ou <code>brew install skaffold</code> (macOS)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python 3.8+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Avec le package python-dotenv - <code>pip install python-dotenv</code></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_lancement_rapide"><a class="anchor" href="#_lancement_rapide"></a>Lancement rapide</h3>
<div class="paragraph">
<p><strong>IMPORTANT:</strong> Le Makefile utilise des commandes Unix et permet de remplacer l&#8217;ensemble des commandesq si dessous.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Utiliser Git Bash au lieu de PowerShell
# Dans Git Bash
make dev
# Installation compl√®te + donn√©es de test
make dev-with-data</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_commandes_manuelles_powershell"><a class="anchor" href="#_commandes_manuelles_powershell"></a>Commandes manuelles (PowerShell)</h4>
<div class="paragraph">
<p>Si vous ne pouvez pas utiliser WSL/Git Bash, utilisez les commandes d√©taill√©es ci-dessous.</p>
</div>
<div class="paragraph">
<p>Pour Linux (Debian/Ubuntu):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Minikube
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube

# kubectl
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl

# Skaffold
curl -Lo skaffold https://storage.googleapis.com/skaffold/releases/latest/skaffold-linux-amd64
sudo install skaffold /usr/local/bin/

# Python-dotenv
pip install python-dotenv</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_des_secrets"><a class="anchor" href="#_configuration_des_secrets"></a>Configuration des Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pour le d√©veloppement local et les d√©ploiements, EXAI utilise un fichier <code>.env</code> √† la racine et des scripts Python pour g√©rer les secrets Kubernetes.</p>
</div>
<div class="sect2">
<h3 id="_1_cr√©er_un_fichier_env"><a class="anchor" href="#_1_cr√©er_un_fichier_env"></a>1. Cr√©er un fichier <code>.env</code></h3>
<div class="paragraph">
<p>Cr√©ez un fichier <code>.env</code> √† la racine du projet avec les variables suivantes :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Cl√© secr√®te pour JWT (doit √™tre identique √† celle utilis√©e pour g√©n√©rer les tokens)
JWT_SECRET_KEY=09d25e094faa6ca2556c818166b7a9563b93f7099f6f0f4caa6cf63b88e8d3e7

# URL Base de donn√©es (g√©n√©ralement pointant vers le service K8s)
DATABASE_URL=postgresql+asyncpg://exai_user:password@postgresql-service.exai.svc.cluster.local:5432/exai_db

# Identifiants Google OAuth
GOOGLE_CLIENT_ID=votre-client-id-google
GOOGLE_CLIENT_SECRET=votre-client-secret-google

# URL de redirection OAuth (FRONTEND) pour le d√©veloppement LOCAL
# Cette valeur sera utilis√©e par d√©faut par l'API Gateway.
# Elle sera surcharg√©e en production par un secret GitHub Actions.
# Utilis√©e par k8s/base/api-gateway/gateway-secrets.yaml (placeholder: REPLACE_WITH_OAUTH_REDIRECT_URL)
OAUTH_REDIRECT_URL=http://localhost:8080/authentication/callback

# URLs des services backend pour le reverse proxy de l'API Gateway
# Ces URLs permettent √† l'API Gateway de rediriger les requ√™tes vers les bons services

# Service de s√©lection des datasets
# D√©veloppement local (Minikube) - valeur par d√©faut
SERVICE_SELECTION_URL=http://service-selection-service.exai.svc.cluster.local
# D√©veloppement local (services en local)
# SERVICE_SELECTION_URL=http://localhost:8001

# Pipeline ML
# D√©veloppement local (Minikube) - valeur par d√©faut
ML_PIPELINE_URL=http://ml-pipeline-service.exai.svc.cluster.local
# D√©veloppement local (services en local)
# ML_PIPELINE_URL=http://localhost:8002

# Moteur XAI
# D√©veloppement local (Minikube) - valeur par d√©faut
XAI_ENGINE_URL=http://xai-engine-service.exai.svc.cluster.local
# D√©veloppement local (services en local)
# XAI_ENGINE_URL=http://localhost:8003

# Domaines de production pour la d√©tection automatique HTTPS
PRODUCTION_DOMAINS=your-domain.com,api.your-domain.com

# Origins autoris√©es pour CORS (s√©par√©es par des virgules)
BACKEND_CORS_ORIGINS=http://localhost:8080,https://your-domain.com,https://www.your-domain.com</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Le fichier <code>.env</code> est d√©j√† ajout√© √† <code>.gitignore</code> pour √©viter de commiter des secrets. Adaptez les valeurs √† votre propre configuration, notamment les identifiants Google.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_2_mettre_√†_jour_les_secrets_kubernetes"><a class="anchor" href="#_2_mettre_√†_jour_les_secrets_kubernetes"></a>2. Mettre √† jour les secrets Kubernetes</h3>
<div class="paragraph">
<p>Avant de d√©marrer l&#8217;application avec Skaffold ou de g√©n√©rer les manifestes finaux, ex√©cutez :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Met √† jour les placeholders dans les fichiers secrets avec les valeurs du .env (encod√©es en base64)
python -m scripts.update-local-secrets</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce script (<code>scripts/update_local_secrets.py</code>) lit le fichier <code>.env</code> et remplace les placeholders correspondants dans les fichiers YAML de Kubernetes :
- Il met √† jour <code>k8s/base/api-gateway/gateway-secrets.yaml</code> avec les valeurs de <code>JWT_SECRET_KEY</code>, <code>DATABASE_URL</code>, <code>GOOGLE_CLIENT_ID</code>, <code>GOOGLE_CLIENT_SECRET</code>, et <code>OAUTH_REDIRECT_URL</code> (via <code>REPLACE_WITH_&#8230;&#8203;</code>).
- Il <strong>ne modifie plus</strong> de patch sp√©cifique pour l&#8217;URL de redirection en production.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ex√©cutez ce script chaque fois que vous modifiez le fichier <code>.env</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_3_restaurer_les_placeholders_avant_de_commiter"><a class="anchor" href="#_3_restaurer_les_placeholders_avant_de_commiter"></a>3. Restaurer les placeholders avant de commiter</h3>
<div class="paragraph">
<p>Avant de pousser votre code vers le d√©p√¥t Git, il est recommand√© d&#8217;ex√©cuter le script inverse pour remettre les placeholders g√©n√©riques dans les fichiers YAML. Cela √©vite de commiter accidentellement des valeurs sp√©cifiques √† votre environnement local.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Restaure les placeholders g√©n√©riques (REPLACE_WITH_...) dans les fichiers de secrets
python -m scripts.reset-placeholders</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d√©marrage_ultra_rapide"><a class="anchor" href="#_d√©marrage_ultra_rapide"></a>üöÄ D√©marrage Ultra-Rapide</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Linux/macOS/WSL/Git Bash:</strong> Toutes les √©tapes ci-dessous peuvent √™tre r√©alis√©es en une seule commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">make dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette commande d√©marre Minikube, d√©ploie l&#8217;application, ex√©cute les migrations et affiche les logs.</p>
</div>
<div class="paragraph">
<p><strong>Windows PowerShell:</strong> Utilisez les commandes d√©taill√©es ci-dessous.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d√©marrage_manuel_windows_powershell"><a class="anchor" href="#_d√©marrage_manuel_windows_powershell"></a>ü™ü D√©marrage Manuel (Windows PowerShell)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Si vous ne pouvez pas utiliser WSL/Git Bash, voici les √©tapes d√©taill√©es :</p>
</div>
<div class="sect2">
<h3 id="_1_v√©rification_des_pr√©requis"><a class="anchor" href="#_1_v√©rification_des_pr√©requis"></a>1. V√©rification des pr√©requis</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># V√©rifier que les outils sont install√©s
docker --version
minikube version
kubectl version --client
skaffold version
python --version

# V√©rifier le fichier .env
if (Test-Path .env) { "‚úÖ Fichier .env trouv√©" } else { "‚ùå Fichier .env manquant" }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2_d√©marrage_de_minikube"><a class="anchor" href="#_2_d√©marrage_de_minikube"></a>2. D√©marrage de Minikube</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># D√©marrer Minikube
minikube start --memory 4096 --cpus 2 --disk-size 20g
minikube addons enable ingress
minikube addons enable storage-provisioner</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_configuration"><a class="anchor" href="#_3_configuration"></a>3. Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># Cr√©er le namespace
kubectl create namespace exai

# Mettre √† jour les secrets
python -m scripts.update-local-secrets

# Configurer Docker pour Minikube
&amp; minikube -p minikube docker-env --shell powershell | Invoke-Expression</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_4_d√©ploiement"><a class="anchor" href="#_4_d√©ploiement"></a>4. D√©ploiement</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># D√©ployer l'application
skaffold run --profile=local --namespace=exai</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_5_attendre_que_les_services_soient_pr√™ts"><a class="anchor" href="#_5_attendre_que_les_services_soient_pr√™ts"></a>5. Attendre que les services soient pr√™ts</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># Attendre PostgreSQL
kubectl wait --for=condition=ready pod -l app=postgresql -n exai --timeout=300s

# Attendre API Gateway
kubectl wait --for=condition=ready pod -l app=api-gateway -n exai --timeout=300s

# Attendre Service Selection
kubectl wait --for=condition=ready pod -l app=service-selection -n exai --timeout=300s</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_6_migrations"><a class="anchor" href="#_6_migrations"></a>6. Migrations</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># Supprimer les anciens jobs
kubectl delete job api-gateway-migration-job -n exai --ignore-not-found=true
kubectl delete job service-selection-migration-job -n exai --ignore-not-found=true

# Lancer les migrations
kubectl apply -f k8s/base/jobs/api-gateway-migration-job.yaml -n exai
kubectl wait --for=condition=complete job/api-gateway-migration-job -n exai --timeout=300s

kubectl apply -f k8s/base/jobs/service-selection-migration-job.yaml -n exai
kubectl wait --for=condition=complete job/service-selection-migration-job -n exai --timeout=300s</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_7_acc√®s_aux_services"><a class="anchor" href="#_7_acc√®s_aux_services"></a>7. Acc√®s aux services</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-powershell hljs" data-lang="powershell"># D√©marrer les logs et redirections de port
skaffold dev --profile=local --namespace=exai</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Acc√®s aux services :</strong>
- <strong>Frontend:</strong> <a href="http://localhost:8080" class="bare">http://localhost:8080</a>
- <strong>API Gateway:</strong> <a href="http://localhost:9000" class="bare">http://localhost:9000</a>
- <strong>Documentation API:</strong> <a href="http://localhost:9000/docs" class="bare">http://localhost:9000/docs</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d√©ploiement_local_avec_minikube_et_skaffold"><a class="anchor" href="#_d√©ploiement_local_avec_minikube_et_skaffold"></a>D√©ploiement Local avec Minikube et Skaffold</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Cloner le d√©p√¥t</strong> (si pas d√©j√† fait):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone &lt;URL_DU_DEPOT_GIT_EXAI&gt;
cd &lt;NOM_DU_DOSSIER_PROJET_EXAI&gt;</code></pre>
</div>
</div>
</li>
<li>
<p><strong>D√©marrer Minikube</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">minikube start
# Pour plus de ressources: minikube start --memory 4096 --cpus 2</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Assurez-vous que l&#8217;addon <code>ingress</code> est activ√© si vous comptez tester le d√©ploiement avec Ingress plus tard (bien que non utilis√© pour l&#8217;acc√®s local par d√©faut d√©crit ici). L&#8217;addon <code>storage-provisioner</code> est √©galement n√©cessaire et g√©n√©ralement activ√© par d√©faut.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Cr√©er le namespace</strong> (si pas d√©j√† fait):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl create namespace exai
# Ignorez l'erreur si le namespace existe d√©j√†.</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Mettre √† jour les secrets Kubernetes</strong> (voir section pr√©c√©dente) :</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python -m scripts.update-local-secrets</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Configurer l&#8217;environnement Docker</strong> :</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Linux/macOS
eval $(minikube docker-env)

# Windows (PowerShell)
&amp; minikube -p minikube docker-env --shell powershell | Invoke-Expression

# Windows (cmd.exe)
@FOR /f "tokens=*" %i IN ('minikube -p minikube docker-env --shell cmd') DO @%i</code></pre>
</div>
</div>
</li>
<li>
<p><strong>D√©ployer avec Skaffold</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Pour le mode local (d√©veloppement)
skaffold dev --profile=local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Skaffold va :</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>D√©tecter le contexte Minikube et utiliser son environnement Docker.</p>
</li>
<li>
<p>Construire les images Docker n√©cessaires (si le code a chang√©).</p>
</li>
<li>
<p>D√©ployer les manifestes Kubernetes d√©finis dans <code>skaffold.yaml</code> pour le profil <code>local</code> (Base de donn√©es, API Gateway, Service Selection, Frontend) dans le namespace <code>exai</code>.</p>
</li>
<li>
<p>Mettre en place des redirections de port automatiques (voir section Acc√®s).</p>
</li>
<li>
<p>Surveiller les changements de code et red√©ployer automatiquement.</p>
</li>
<li>
<p>Afficher les logs des conteneurs en temps r√©el dans la console.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Le premier d√©ploiement peut prendre plusieurs minutes. Attendez que Skaffold indique <code>Deployments stabilized</code> ou que tous les pods principaux (<code>postgresql</code>, <code>api-gateway</code>, <code>service-selection</code>, <code>frontend</code>) passent √† l&#8217;√©tat <code>Running</code> (vous pouvez v√©rifier avec <code>kubectl get pods -n exai</code>).</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_initialisation_de_la_base_de_donn√©es"><a class="anchor" href="#_initialisation_de_la_base_de_donn√©es"></a>Initialisation de la Base de Donn√©es</h3>
<div class="paragraph">
<p>L&#8217;architecture EXAI utilise une base de donn√©es PostgreSQL partag√©e par tous les microservices, chaque service g√©rant ses migrations sp√©cifiques.</p>
</div>
<div class="paragraph">
<p>Ex√©cutez les migrations depuis les pods Kubernetes :</p>
</div>
<div class="sect3">
<h4 id="_service_de_s√©lection"><a class="anchor" href="#_service_de_s√©lection"></a>Service de S√©lection</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># 1. Identifier le pod
kubectl get pods -n exai -l app=service-selection

# 2. Ex√©cuter la migration (remplacer &lt;pod-name&gt;)
kubectl exec -it &lt;pod-name&gt; -n exai -- bash -c "cd /app &amp;&amp; DATABASE_URL='postgresql+asyncpg://exai_user:password@postgresql-service:5432/exai_db' alembic upgrade head"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_gateway"><a class="anchor" href="#_api_gateway"></a>API Gateway</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Identifier le pod et ex√©cuter la migration
kubectl get pods -n exai -l app=api-gateway
kubectl exec -it &lt;pod-name&gt; -n exai -- bash -c "cd /app &amp;&amp; DATABASE_URL='postgresql+asyncpg://exai_user:password@postgresql-service:5432/exai_db' alembic upgrade head"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ces commandes ex√©cutent les migrations Alembic directement √† l&#8217;int√©rieur des pods. Cela √©vite les probl√®mes de connectivit√© et assure que la configuration est identique √† celle utilis√©e par l&#8217;application.</p>
</div>
<div class="paragraph">
<p>Chaque service utilise sa propre table de version Alembic (<code>alembic_version_gateway</code> et <code>alembic_version_selection</code>) pour suivre ses migrations dans la base de donn√©es partag√©e.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_acc√©der_√†_lapplication"><a class="anchor" href="#_acc√©der_√†_lapplication"></a>Acc√©der √† l&#8217;Application</h3>
<div class="paragraph">
<p>Avec le profil <code>local</code>, Skaffold configure automatiquement des redirections de port (<code>port-forward</code>) pour faciliter l&#8217;acc√®s. <strong>Il n&#8217;est PAS n√©cessaire d&#8217;utiliser <code>minikube service</code> ou <code>minikube tunnel</code> pour ce workflow local par d√©faut.</strong></p>
</div>
<div class="paragraph">
<p>Les services sont accessibles directement sur <code>localhost</code> via les ports suivants (tant que <code>skaffold dev --profile=local</code> est actif) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Frontend :</strong> <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code></p>
</li>
<li>
<p><strong>API Gateway :</strong> <code><a href="http://localhost:9000" class="bare">http://localhost:9000</a></code>
<strong>Documentation API (Swagger UI) :</strong> <code><a href="http://localhost:9000/docs" class="bare">http://localhost:9000/docs</a></code>
<strong>Documentation API (ReDoc) :</strong> <code><a href="http://localhost:9000/redoc" class="bare">http://localhost:9000/redoc</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Le frontend est configur√© (via <code>frontend/src/environments/environment.ts</code>) pour appeler l&#8217;API Gateway sur <code><a href="http://localhost:9000" class="bare">http://localhost:9000</a></code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workflow_de_d√©veloppement"><a class="anchor" href="#_workflow_de_d√©veloppement"></a>Workflow de D√©veloppement</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_structure_des_fichiers_kubernetes"><a class="anchor" href="#_structure_des_fichiers_kubernetes"></a>Structure des Fichiers Kubernetes</h3>
<div class="paragraph">
<p>Le projet utilise Kustomize pour g√©rer les configurations Kubernetes de mani√®re structur√©e :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">k8s/
‚îú‚îÄ‚îÄ base/                      # Configurations communes √† tous les environnements
‚îÇ   ‚îú‚îÄ‚îÄ api-gateway/           # Manifestes pour l'API Gateway (Deployment, Service, Secrets...)
‚îÇ   ‚îú‚îÄ‚îÄ frontend/              # Manifestes pour le Frontend
‚îÇ   ‚îú‚îÄ‚îÄ postgres/              # Manifestes pour PostgreSQL (StatefulSet, Service, PVC...)
‚îÇ   ‚îú‚îÄ‚îÄ service-selection/     # Manifestes pour le Service Selection
‚îÇ   ‚îî‚îÄ‚îÄ kustomization.yaml     # R√©f√©rence toutes les ressources de la base
‚îî‚îÄ‚îÄ overlays/                  # Surcouches pour des environnements sp√©cifiques
    ‚îú‚îÄ‚îÄ minikube/              # Configurations pour le d√©veloppement local (Minikube)
    ‚îÇ   ‚îú‚îÄ‚îÄ kustomization.yaml # R√©f√©rence la base et applique des patches sp√©cifiques (ex: type Service)
    ‚îÇ   ‚îî‚îÄ‚îÄ ... (patches si n√©cessaire)
    ‚îî‚îÄ‚îÄ azure/                 # Configurations pour le d√©ploiement en production (Azure)
        ‚îú‚îÄ‚îÄ kustomization.yaml # R√©f√©rence la base et applique des patches (ex: Ingress)
        ‚îî‚îÄ‚îÄ ... (autres patches ou ressources sp√©cifiques)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette structure permet de :
- D√©finir les ressources principales une seule fois dans <code>base/</code>.
- Personnaliser la configuration pour chaque environnement (local, production) dans <code>overlays/</code> en utilisant des patches ou des ressources suppl√©mentaires.
- Pour la production (Azure), les secrets sensibles comme l&#8217;URL de la base de donn√©es ou l&#8217;URL de redirection OAuth sont inject√©s via le pipeline CI/CD (GitHub Actions) qui modifie directement les manifestes de base avant le d√©ploiement par Skaffold/Kustomize.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cycle_de_d√©veloppement_avec_skaffold"><a class="anchor" href="#_cycle_de_d√©veloppement_avec_skaffold"></a>Cycle de D√©veloppement avec Skaffold</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modifiez votre code dans l&#8217;un des microservices (frontend, api-gateway, service-selection)</p>
</li>
<li>
<p>Skaffold d√©tecte automatiquement les changements</p>
</li>
<li>
<p>Reconstruction et red√©ploiement automatiques des images Docker affect√©es</p>
</li>
<li>
<p>Services red√©marr√©s avec le nouveau code</p>
</li>
<li>
<p>Visualisez les logs en temps r√©el dans la console Skaffold</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Pour un workflow plus fluide, utilisez des outils comme <strong>Lens</strong>, <strong>k9s</strong> ou le <strong>Kubernetes Dashboard</strong> (<code>minikube dashboard</code>).
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d√©pannage"><a class="anchor" href="#_d√©pannage"></a>D√©pannage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_probl√®mes_courants"><a class="anchor" href="#_probl√®mes_courants"></a>Probl√®mes Courants</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Minikube ne d√©marre pas</strong> : V√©rifiez Docker Desktop, essayez <code>minikube delete</code> puis <code>minikube start</code></p>
</li>
<li>
<p><strong>Pod bloqu√© en <code>Pending</code></strong> : Augmentez les ressources (<code>minikube stop &amp;&amp; minikube config set memory 4096 &amp;&amp; minikube start</code>)</p>
</li>
<li>
<p><strong>Pod en <code>CrashLoopBackOff</code></strong> : V√©rifiez les logs avec <code>kubectl logs -n exai &lt;pod-name&gt;</code></p>
</li>
<li>
<p><strong>Services inaccessibles</strong> : V√©rifiez que <code>skaffold dev --profile=local</code> est en cours d&#8217;ex√©cution et qu&#8217;aucun autre programme n&#8217;utilise les ports locaux <code>8080</code> ou <code>9000</code>. V√©rifiez les logs Skaffold pour des erreurs de port-forwarding. Assurez-vous que les pods sont <code>Running</code> (<code>kubectl get pods -n exai</code>).</p>
</li>
<li>
<p><strong>Pod PostgreSQL bloqu√© en <code>Pending</code></strong> : V√©rifiez les PVC (<code>kubectl get pvc -n exai</code>) et la StorageClass (<code>kubectl get sc</code>). Assurez-vous que la configuration du volume dans <code>k8s/base/postgres/postgresql-statefulset.yaml</code> utilise la bonne <code>storageClassName</code> (<code>standard</code> pour Minikube par d√©faut).</p>
</li>
<li>
<p><strong>Erreurs "MIME type" sur le frontend</strong> : Assurez-vous que la configuration Nginx (<code>frontend/nginx.conf</code>), le Dockerfile (<code>frontend/Dockerfile</code>), et le <code>baseHref</code> dans <code>angular.json</code> sont coh√©rents pour un service √† la racine (<code>/</code>).</p>
</li>
<li>
<p><strong>Secrets incorrects</strong> : Si vous rencontrez des erreurs d&#8217;authentification, v√©rifiez que vous avez bien ex√©cut√© <code>python -m scripts.update-local-secrets</code> apr√®s avoir mis √† jour votre fichier <code>.env</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_√©tapes_de_diagnostic"><a class="anchor" href="#_√©tapes_de_diagnostic"></a>√âtapes de Diagnostic</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Logs Skaffold</p>
</li>
<li>
<p>√âtat des pods : <code>kubectl get pods -n exai</code></p>
</li>
<li>
<p>D√©tails d&#8217;un pod : <code>kubectl describe pod &lt;pod-name&gt; -n exai</code></p>
</li>
<li>
<p>Logs d&#8217;un pod : <code>kubectl logs -n exai &lt;pod-name&gt;</code></p>
</li>
<li>
<p>Logs Minikube : <code>minikube logs</code></p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_arr√™ter_lenvironnement"><a class="anchor" href="#_arr√™ter_lenvironnement"></a>Arr√™ter l&#8217;environnement</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Arr√™ter Skaffold : Ctrl+C

# Arr√™ter Minikube
minikube stop

# Supprimer compl√®tement Minikube (supprime les donn√©es)
minikube delete</code></pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>

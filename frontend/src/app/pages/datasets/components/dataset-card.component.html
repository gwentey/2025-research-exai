<mat-card class="dataset-card" [ngClass]="{'compact': compact}">
  <!-- En-tête avec titre et badges -->
  <mat-card-header>
    <div mat-card-avatar class="dataset-avatar">
      <mat-icon>dataset</mat-icon>
    </div>
    <mat-card-title class="dataset-title">
      {{ dataset.dataset_name }}
      <mat-icon 
        *ngIf="isPublic()" 
        class="access-icon public" 
        matTooltip="Dataset public">
        public
      </mat-icon>
      <mat-icon 
        *ngIf="!isPublic()" 
        class="access-icon private" 
        matTooltip="Dataset privé">
        lock
      </mat-icon>
    </mat-card-title>
    <mat-card-subtitle>
      <span class="year">{{ getYear() }}</span>
      <span class="citations" *ngIf="getCitations() > 0">
        <mat-icon class="citation-icon">format_quote</mat-icon>
        {{ getCitations() }}
      </span>
    </mat-card-subtitle>
  </mat-card-header>

  <!-- Contenu principal -->
  <mat-card-content>
    <!-- Description -->
    <p class="description" *ngIf="!compact">
      {{ getTruncatedDescription() }}
    </p>

    <!-- Statistiques principales -->
    <div class="stats-grid">
      <div class="stat-item">
        <mat-icon>storage</mat-icon>
        <div class="stat-info">
          <span class="stat-label">Instances</span>
          <span class="stat-value">{{ getFormattedInstancesCount() }}</span>
        </div>
      </div>
      <div class="stat-item">
        <mat-icon>view_column</mat-icon>
        <div class="stat-info">
          <span class="stat-label">Features</span>
          <span class="stat-value">{{ getFeaturesCount() }}</span>
        </div>
      </div>
      <div class="stat-item">
        <mat-icon>security</mat-icon>
        <div class="stat-info">
          <span class="stat-label">Score éthique</span>
          <span class="stat-value" [ngClass]="getEthicalScoreClass()">
            {{ getEthicalScore() }}%
          </span>
        </div>
      </div>
    </div>

    <!-- Indicateurs de qualité -->
    <div class="quality-indicators" *ngIf="!compact">
      <div class="indicator-row">
        <div class="indicator">
          <mat-icon 
            [color]="isSplit() ? 'primary' : 'warn'" 
            matTooltip="Dataset divisé (train/test)">
            {{ isSplit() ? 'check_circle' : 'cancel' }}
          </mat-icon>
          <span class="indicator-label">Divisé</span>
        </div>
        <div class="indicator">
          <mat-icon 
            [color]="isAnonymized() ? 'primary' : 'warn'" 
            matTooltip="Dataset anonymisé">
            {{ isAnonymized() ? 'check_circle' : 'cancel' }}
          </mat-icon>
          <span class="indicator-label">Anonymisé</span>
        </div>
        <div class="indicator">
          <mat-icon 
            [color]="hasTemporalFactors() ? 'primary' : 'accent'" 
            matTooltip="Facteurs temporels présents">
            {{ hasTemporalFactors() ? 'schedule' : 'schedule_disabled' }}
          </mat-icon>
          <span class="indicator-label">Temporel</span>
        </div>
      </div>
      
      <!-- Valeurs manquantes -->
      <div class="missing-values" *ngIf="hasMissingValues()">
        <mat-icon color="warn">warning</mat-icon>
        <span>{{ getMissingPercentage() }}% valeurs manquantes</span>
      </div>
    </div>

    <!-- Domaines d'application -->
    <div class="domains-section" *ngIf="getDisplayedDomains().length > 0">
      <div class="section-title">
        <mat-icon>domain</mat-icon>
        <span>Domaines</span>
      </div>
      <div class="chips-container">
        <mat-chip 
          *ngFor="let domain of getDisplayedDomains()" 
          [color]="getDomainColor(domain)">
          {{ domain }}
        </mat-chip>
        <mat-chip 
          *ngIf="getRemainingDomainsCount() > 0" 
          color="accent">
          +{{ getRemainingDomainsCount() }}
        </mat-chip>
      </div>
    </div>

    <!-- Tâches ML -->
    <div class="tasks-section" *ngIf="getDisplayedTasks().length > 0">
      <div class="section-title">
        <mat-icon>psychology</mat-icon>
        <span>Tâches ML</span>
      </div>
      <div class="chips-container">
        <mat-chip 
          *ngFor="let task of getDisplayedTasks()"
          color="primary">
          <mat-icon matChipAvatar>{{ getTaskIcon(task) }}</mat-icon>
          {{ task }}
        </mat-chip>
        <mat-chip 
          *ngIf="getRemainingTasksCount() > 0" 
          color="accent">
          +{{ getRemainingTasksCount() }}
        </mat-chip>
      </div>
    </div>

    <!-- Représentativité -->
    <div class="representativity" *ngIf="!compact">
      <div class="section-title">
        <mat-icon>analytics</mat-icon>
        <span>Représentativité</span>
      </div>
      <div class="repr-badge" [ngClass]="getRepresentativityClass()">
        {{ getRepresentativityLevel() }}
      </div>
    </div>
  </mat-card-content>

  <!-- Actions -->
  <mat-card-actions *ngIf="showActions">
    <button 
      mat-button 
      color="primary" 
      (click)="viewDataset()"
      matTooltip="Voir les détails">
      <mat-icon>visibility</mat-icon>
      Voir
    </button>
    <button 
      mat-button 
      color="accent" 
      (click)="selectDataset()"
      matTooltip="Sélectionner ce dataset">
      <mat-icon>add_task</mat-icon>
      Sélectionner
    </button>
    <button 
      mat-icon-button 
      (click)="toggleFavorite()"
      matTooltip="Ajouter aux favoris">
      <mat-icon>favorite_border</mat-icon>
    </button>
  </mat-card-actions>

  <!-- Footer avec dates -->
  <div class="card-footer" *ngIf="!compact">
    <div class="footer-info">
      <span class="created-date">
        <mat-icon>add_circle</mat-icon>
        Créé le {{ getCreatedDate() }}
      </span>
      <span class="updated-date">
        <mat-icon>update</mat-icon>
        Mis à jour le {{ getUpdatedDate() }}
      </span>
    </div>
  </div>
</mat-card> 